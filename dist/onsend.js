/*! For license information please see onsend.js.LICENSE.txt */
!function(){var e={47309:function(e,t,n){"use strict";var s=n(82702).Promise,r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=s))((function(s,r){function i(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,o,s,r,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(s=2&r[0]?o.return:r[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,r[1])).done)return s;switch(o=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,o=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!((s=(s=i.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){i=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){i.label=r[1];break}if(6===r[0]&&i.label<s[1]){i.label=s[1],s=r;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(r);break}s[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],o=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.setRoamingSettingFromLocalStorage=t.setLocalStorageFromRoamingSetting=t.promiseSaveRoamingSetting=t.promiseSetDefferedDeliveryTime=t.extractCustomMessageItemInfo=t.promiseGetItemId=t.promiseSaveAsDraft=t.getDomainFromEmailAddress=t.promiseOpenDialog=t.promiseDisplayErrorMessage=t.promiseDisplayMessage=t.promiseGetItem=t.getGlobal=t.MailPropertyType=t.DialogMessageCancel=t.BasicFontSizePt=t.FontSizeChoice=t.SettingKeyAccessibilitySize=t.SettingKeyDelaySendKey=t.MaximumRecipients=t.DialogTimeout=t.DialogTimeoutWarning=t.NotificationKeyError=t.NotificationKeyInfo=void 0;var a,c=n(73954);function l(e,t,n){console.log("[START] promiseReplaceNotificationMessage");var o={message:n.substr(0,120),type:t};return t==Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage&&(o.icon="Icon.80x80",o.persistent=!0),console.log("[END] promiseReplaceNotificationMessage"),new s((function(t,n){Office.context.mailbox.item.notificationMessages.replaceAsync(e,o,null,(function(e){console.log("[promiseReplaceNotificationMessage] 完了しました。status : "+e.status),e.status==Office.AsyncResultStatus.Failed?n(e.error):t()}))}))}function u(e){var t='<?xml version="1.0" encoding="utf-8"?>\n  <soap:Envelope xmlns:xsi="https://www.w3.org/2001/XMLSchema-instance"\n                 xmlns:xsd="https://www.w3.org/2001/XMLSchema"\n                 xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages" \n                 xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types" \n                 xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n    <soap:Header>\n      <t:RequestServerVersion Version="Exchange2013" soap:mustUnderstand="0" />\n    </soap:Header>\n    <soap:Body>\n      <m:GetItem>\n        <m:ItemShape>\n          <t:BaseShape>IdOnly</t:BaseShape>\n          <t:AdditionalProperties>\n            <t:FieldURI FieldURI="item:TextBody" />\n          </t:AdditionalProperties>\n        </m:ItemShape>\n        <m:ItemIds>\n          <t:ItemId Id="'+e+'" />\n        </m:ItemIds>\n      </m:GetItem>\n    </soap:Body>\n  </soap:Envelope>';return new s((function(e,n){console.log("[promiseGetTextBody] START/END"),Office.context.mailbox.makeEwsRequestAsync(t,(function(t){if(t.status==Office.AsyncResultStatus.Failed)n(t.error);else try{var o=(new DOMParser).parseFromString(t.value,"text/xml").getElementsByTagNameNS("http://schemas.microsoft.com/exchange/services/2006/types","TextBody")[0];e(o.innerHTML)}catch(e){console.error(e),n(e)}}))}))}function m(e,n,o){var c=this;return console.log("[START/END] promiseGetProperty"),new s((function(s,l){return r(c,void 0,void 0,(function(){var r,c,m,f;return i(this,(function(i){switch(i.label){case 0:if(o!=a.Body)return[3,8];i.label=1;case 1:return i.trys.push([1,6,,7]),e?(c=u,[4,p()]):[3,4];case 2:return[4,c.apply(void 0,[i.sent()])];case 3:return r=i.sent(),s(r.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'")),[3,5];case 4:Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,null,(function(e){console.log("[promiseGetProperty] 完了しました。(Html) status : "+e.status),e.status==Office.AsyncResultStatus.Failed?l(e.error):s(e.value)})),i.label=5;case 5:return[3,7];case 6:return m=i.sent(),l(m),[3,7];case 7:return[3,9];case 8:f=null,o==a.From?f=Office.context.mailbox.item.from:o==a.To?f=Office.context.mailbox.item.to:o==a.Cc?f=Office.context.mailbox.item.cc:o==a.Bcc?f=Office.context.mailbox.item.bcc:o==a.Subject&&(f=Office.context.mailbox.item.subject),f.getAsync(null,(function(e){if(console.log("[promiseGetProperty] 完了しました。status : "+e.status),e.status==Office.AsyncResultStatus.Failed)l(e.error);else if(o==a.To||o==a.Cc||o==a.Bcc){for(var r=[],i=0,c=e.value;i<c.length;i++){var u=c[i];r.push({name:u.displayName,isPrivateDL:!u.emailAddress,type:o,emailAddress:u.emailAddress||"",routingType:"",mailboxType:"",itemId:"",isExternal:u.emailAddress&&n!==(0,t.getDomainFromEmailAddress)(u.emailAddress)})}s(r)}else(o==a.Subject||o==a.From)&&s(e.value)})),i.label=9;case 9:return[2]}}))}))}))}function f(e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,l(t.NotificationKeyInfo,Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,"誤送信防止アドイン : "+e)];case 1:return n.sent(),[2]}}))}))}function p(){return console.log("[START/END] promiseGetItemId"),new s((function(e,t){Office.context.mailbox.item.getItemIdAsync(null,(function(n){console.log("[promiseGetItemId] 完了しました。status : "+n.status),n.status==Office.AsyncResultStatus.Failed?t(n.error):e(n.value)}))}))}function d(e){var t=function(e){for(var t=[],n=0,o=e;n<o.length;n++){var s=o[n],r=s.emailAddress,i="";switch(s.type){case a.To:i="to";break;case a.Cc:i="cc";break;case a.Bcc:i="bcc"}r&&r.indexOf("@")>=0&&t.push(i+":"+r)}return t.join(" AND ")}(e),n='<?xml version="1.0" encoding="utf-8"?>\n  <soap:Envelope xmlns:xsi="https://www.w3.org/2001/XMLSchema-instance" \n               xmlns:xsd="https://www.w3.org/2001/XMLSchema" \n               xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" \n               xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"\n               xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages">\n    <soap:Header>\n      <t:RequestServerVersion Version="Exchange2013" />\n    </soap:Header>\n    <soap:Body>\n      <m:FindItem Traversal="Shallow">\n        <m:ItemShape>\n          <t:BaseShape>IdOnly</t:BaseShape>\n          <t:AdditionalProperties>\n            <t:FieldURI FieldURI="message:ToRecipients" />\n            <t:FieldURI FieldURI="message:CcRecipients" />\n            <t:FieldURI FieldURI="message:BccRecipients" />\n          </t:AdditionalProperties>\n        </m:ItemShape>\n        <m:IndexedPageItemView MaxEntriesReturned="1" Offset="0" BasePoint="Beginning" />\n        <m:ParentFolderIds>\n          <t:DistinguishedFolderId Id="sentitems"/>\n        </m:ParentFolderIds>\n        <m:QueryString>'+t+"</m:QueryString>\n      </m:FindItem>\n    </soap:Body>\n  </soap:Envelope>";return new s((function(e,t){Office.context.mailbox.makeEwsRequestAsync(n,(function(n){if(console.log("[promiseGetSentItems] 完了しました。status : "+n.status),n.status==Office.AsyncResultStatus.Failed)t(n.error);else{var o=(new DOMParser).parseFromString(n.value,"text/xml"),s=[];if("Success"===o.getElementsByTagNameNS("http://schemas.microsoft.com/exchange/services/2006/messages","FindItemResponseMessage")[0].getAttribute("ResponseClass"))for(var r=o.getElementsByTagNameNS("http://schemas.microsoft.com/exchange/services/2006/types","ItemId"),i=0;i<r.length;++i){var a=r[i].getAttribute("Id");s.push(a)}e(s)}}))}))}t.NotificationKeyInfo="OnFcsMailAddin",t.NotificationKeyError="OnFcsMailAddinError",t.DialogTimeoutWarning=269e3,t.DialogTimeout=299e3,t.MaximumRecipients=100,t.SettingKeyDelaySendKey="mail_delay_send_key",t.SettingKeyAccessibilitySize="accessibility_size",t.FontSizeChoice=["small","medium","large"],t.BasicFontSizePt=[12,14,16],t.DialogMessageCancel="<NO>",function(e){e[e.None=0]="None",e[e.From=1]="From",e[e.To=2]="To",e[e.Cc=3]="Cc",e[e.Bcc=4]="Bcc",e[e.Subject=5]="Subject",e[e.Body=6]="Body"}(a=t.MailPropertyType||(t.MailPropertyType={})),t.getGlobal=function(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:void 0},t.promiseGetItem=function(e){var t=this,n='<?xml version="1.0" encoding="utf-8"?>\n  <soap:Envelope xmlns:xsi="https://www.w3.org/2001/XMLSchema-instance"\n                 xmlns:xsd="https://www.w3.org/2001/XMLSchema"\n                 xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages" \n                 xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types" \n                 xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n    <soap:Header>\n      <t:RequestServerVersion Version="Exchange2013" soap:mustUnderstand="0" />\n    </soap:Header>\n    <soap:Body>\n      <m:GetItem>\n        <m:ItemShape>\n          <t:BaseShape>AllProperties</t:BaseShape>\n          <t:AdditionalProperties>\n            <t:ExtendedFieldURI PropertyTag="16367" PropertyType="SystemTime" />\n          </t:AdditionalProperties>\n        </m:ItemShape>\n        <m:ItemIds>\n          <t:ItemId Id="'+e+'" />\n        </m:ItemIds>\n      </m:GetItem>\n    </soap:Body>\n  </soap:Envelope>';return new s((function(e,o){Office.context.mailbox.makeEwsRequestAsync(n,(function(n){return r(t,void 0,void 0,(function(){return i(this,(function(t){return n.status==Office.AsyncResultStatus.Failed?o(n.error):e(n.value),[2]}))}))}))}))},t.promiseDisplayMessage=f,t.promiseDisplayErrorMessage=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,l(t.NotificationKeyError,Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,"誤送信防止アドイン : "+e)];case 1:return n.sent(),[2]}}))}))},t.promiseOpenDialog=function(e){return r(this,void 0,void 0,(function(){var n,o,l,u,p,g,h,y,v,S,w,x;return i(this,(function(b){switch(b.label){case 0:return[4,m(e,null,a.Subject)];case 1:return n=b.sent(),[4,m(e,null,a.Body)];case 2:return o=b.sent(),l=(0,t.getDomainFromEmailAddress)(Office.context.mailbox.userProfile.emailAddress),[4,m(e,l,a.To)];case 3:return u=b.sent(),[4,m(e,l,a.Cc)];case 4:return p=b.sent(),[4,m(e,l,a.Bcc)];case 5:return g=b.sent(),h=u.concat(p).concat(g),window.localStorage.setItem("mail_subject",n),window.localStorage.setItem("mail_body",o),v=(y=window.localStorage).setItem,S=["mail_attachments"],x=(w=JSON).stringify,[4,(console.log("[START/END] promiseGetAttachments"),new s((function(e,t){Office.context.mailbox.item.getAttachmentsAsync(null,(function(n){console.log("[promiseGetAttachments] 完了しました。status : "+n.status),n.status==Office.AsyncResultStatus.Failed?t(n.error):e(n.value)}))})))];case 6:return v.apply(y,S.concat([x.apply(w,[b.sent()])])),window.localStorage.setItem("mail_recipients",JSON.stringify(h)),setTimeout((function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,d(h)];case 1:return e.sent().length>0?window.localStorage.setItem("mail_recipient_pattern_exists","yes"):window.localStorage.setItem("mail_recipient_pattern_exists","no"),[2]}}))}))})),console.log("[START/END] promiseOpenDialog"),[2,new s((function(e,t){Office.context.ui.displayDialogAsync(c.documentRoot+"dialog.html",{height:70,width:70,displayInIframe:!0},(function(n){if(n.status==Office.AsyncResultStatus.Failed)console.error("[promiseOpenDialog] ダイアログを開けませんでした。asRes.error.code : "+n.error.code),t(n.error);else{var o=n.value;o.addEventHandler(Office.EventType.DialogMessageReceived,(function(n){return r(this,void 0,void 0,(function(){var s;return i(this,(function(r){switch(r.label){case 0:console.log("[promiseOpenDialog] メッセージを受信しました。arg.message : "+n.message),r.label=1;case 1:return r.trys.push([1,4,,5]),n.message.indexOf("<ENCRYPT>")>=0?[4,f("処理が完了しました。")]:[3,3];case 2:r.sent(),r.label=3;case 3:return o.close(),n.message.indexOf("<YES>")>=0?e(!0):e(!1),[3,5];case 4:return s=r.sent(),console.error(s),t(s),[3,5];case 5:return[2]}}))}))})),o.addEventHandler(Office.EventType.DialogEventReceived,(function(n){console.log("[promiseOpenDialog] イベントを受信しました。arg.error : "+n.error);var o="";switch(n.error){case 12002:o="Cannot load URL, no such page or bad URL syntax.";break;case 12003:o="HTTPS is required.";break;case 12006:e(!1);break;default:o="Unknown error."}t({code:n.error,message:o,name:"DialogEventReceived"})}))}}))}))]}}))}))},t.getDomainFromEmailAddress=function(e){return e.substr(1+e.lastIndexOf("@"))},t.promiseSaveAsDraft=function(){return console.log("[START/END] promiseSaveAsDraft"),new s((function(e,t){Office.context.mailbox.item.saveAsync(null,(function(n){console.log("[promiseSaveAsDraft] 完了しました。status : "+n.status),n.status==Office.AsyncResultStatus.Failed?t(n.error):e(n.value)}))}))},t.promiseGetItemId=p,t.extractCustomMessageItemInfo=function(e){var t=(new DOMParser).parseFromString(e,"text/xml"),n=t.getElementsByTagNameNS("http://schemas.microsoft.com/exchange/services/2006/types","ItemId")[0],o=n.getAttribute("Id"),s=n.getAttribute("ChangeKey"),r=t.getElementsByTagNameNS("http://schemas.microsoft.com/exchange/services/2006/types","InternetMessageId"),i="";return r.length>0&&(i=(i=r[0].innerHTML).substring(4,i.length-4)),{id:o,changeKey:s,debug:e,internetMessageId:i}},t.promiseSetDefferedDeliveryTime=function(e,t,n){var o=function(e){console.log("[START] getDateStringISO8601");var t=("0000"+e.getFullYear()).slice(-4)+"-"+("00"+(e.getMonth()+1)).slice(-2)+"-"+("00"+e.getDate()).slice(-2)+"T"+("00"+e.getHours()).slice(-2)+":"+("00"+e.getMinutes()).slice(-2)+":"+("00"+e.getSeconds()).slice(-2);return console.log("[END] getDateStringISO8601"),t}(new Date((new Date).getTime()+6e4*t-324e5)),r='<?xml version="1.0" encoding="utf-8"?>\n  <soap:Envelope xmlns:xsi="https://www.w3.org/2001/XMLSchema-instance" \n               xmlns:xsd="https://www.w3.org/2001/XMLSchema" \n               xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" \n               xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">\n    <soap:Header>\n      <t:RequestServerVersion Version="Exchange2013" soap:mustUnderstand="0" />\n    </soap:Header>\n    <soap:Body>\n      <UpdateItem MessageDisposition="'+(n?"SaveOnly":"SendOnly")+'" ConflictResolution="AutoResolve" \n                  xmlns="http://schemas.microsoft.com/exchange/services/2006/messages">\n        <ItemChanges>\n          <t:ItemChange>\n            <t:ItemId Id="'+e.id+'" ChangeKey="'+e.changeKey+'" />\n            <t:Updates>\n              <t:SetItemField>\n                <t:ExtendedFieldURI PropertyTag="16367" PropertyType="SystemTime" />\n                <t:Message>\n                  <t:ExtendedProperty>\n                    <t:ExtendedFieldURI PropertyTag="16367"\n                                        PropertyType="SystemTime" />\n                    <t:Value>'+o+"</t:Value>\n                  </t:ExtendedProperty>\n                </t:Message>\n              </t:SetItemField>\n            </t:Updates>\n          </t:ItemChange>\n        </ItemChanges>\n      </UpdateItem>\n    </soap:Body>\n  </soap:Envelope>";return console.log("[START/END] promiseSetDefferedDeliveryTime"),new s((function(e,t){Office.context.mailbox.makeEwsRequestAsync(r,(function(n){if(console.log("[promiseSetDefferedDeliveryTime] 完了しました。status : "+n.status),n.status==Office.AsyncResultStatus.Failed)t(n.error);else try{if("Success"!==(new DOMParser).parseFromString(n.value,"text/xml").getElementsByTagNameNS("http://schemas.microsoft.com/exchange/services/2006/messages","UpdateItemResponseMessage")[0].getAttribute("ResponseClass"))throw new Error("promiseSetDefferedDeliveryTime failed.");e(!0)}catch(e){e.message="[promiseSetDefferedDeliveryTime] "+e.message,t(e)}}))}))},t.promiseSaveRoamingSetting=function(){return console.log("[START/END] promiseSaveRoamingSetting"),new s((function(e,t){Office.context.roamingSettings.saveAsync((function(n){n.status!==Office.AsyncResultStatus.Succeeded?t(n.error):(console.log("[promiseSaveRoamingSetting] 完了しました。status : "+n.status),e())}))}))},t.setLocalStorageFromRoamingSetting=function(e,t){var n=Office.context.roamingSettings.get(e)||t;window.localStorage.setItem(e,n)},t.setRoamingSettingFromLocalStorage=function(e){Office.context.roamingSettings.set(e,window.localStorage.getItem(e))},function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==o?o:t;if(n)if("function"!=typeof n){for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){var r=void 0;try{r=n[s]}catch(e){continue}e.register(r,s,"C:\\Users\\youhei_mori\\Desktop\\RDI\\outlook-check-recipients-addin-github\\src\\common.ts")}}else e.register(n,"module.exports","C:\\Users\\youhei_mori\\Desktop\\RDI\\outlook-check-recipients-addin-github\\src\\common.ts")}}()},75081:function(e,t,n){"use strict";var s=n(82702).Promise,r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=s))((function(s,r){function i(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,o,s,r,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(s=2&r[0]?o.return:r[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,r[1])).done)return s;switch(o=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,o=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!((s=(s=i.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){i=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){i.label=r[1];break}if(6===r[0]&&i.label<s[1]){i.label=s[1],s=r;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(r);break}s[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],o=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(47309);function c(e){return r(this,void 0,void 0,(function(){var t,n,o,s,r,c,l,u,m,f;return i(this,(function(i){switch(i.label){case 0:t=Office.context.platform==Office.PlatformType.OfficeOnline,n=!1,o=!1,i.label=1;case 1:return i.trys.push([1,14,22,23]),"message"!==Office.context.mailbox.item.itemType?[3,12]:(window.localStorage.clear(),window.localStorage.setItem("time_activated",(new Date).toISOString()),[4,a.promiseSaveAsDraft()]);case 2:return i.sent(),[4,a.promiseDisplayMessage("メッセージを下書き保存しました。")];case 3:return i.sent(),[4,a.promiseDisplayMessage("アイテムから情報を取得しました。")];case 4:return i.sent(),a.setLocalStorageFromRoamingSetting(a.SettingKeyDelaySendKey,"delay_send_0"),a.setLocalStorageFromRoamingSetting("width_recipient_name","120"),a.setLocalStorageFromRoamingSetting("width_recipient_address","220"),a.setLocalStorageFromRoamingSetting("width_attachment_name","120"),a.setLocalStorageFromRoamingSetting("width_attachment_size","70"),a.setLocalStorageFromRoamingSetting(a.SettingKeyAccessibilitySize,a.FontSizeChoice[1]),[4,a.promiseOpenDialog(t)];case 5:if(!i.sent())throw o=!0,new Error("キャンセルしました。");if("timeout"===window.localStorage.getItem("timeout"))throw new Error("処理がタイムアウトしました。");return t?(s=window.localStorage.getItem(a.SettingKeyDelaySendKey),Office.context.roamingSettings.set(a.SettingKeyDelaySendKey,s),(r=Math.floor(parseFloat(s.substring(s.lastIndexOf("_")+1))))>0&&r<30?[4,a.promiseGetItemId()]:[3,9]):[3,10];case 6:return c=i.sent(),[4,a.promiseGetItem(c)];case 7:return l=i.sent(),u=a.extractCustomMessageItemInfo(l),[4,a.promiseSetDefferedDeliveryTime(u,r,t)];case 8:return i.sent(),[3,10];case 9:if(r>=30)throw new Error("遅延送信情報が不正です。");i.label=10;case 10:return a.setRoamingSettingFromLocalStorage("width_recipient_name"),a.setRoamingSettingFromLocalStorage("width_recipient_address"),a.setRoamingSettingFromLocalStorage("width_attachment_name"),a.setRoamingSettingFromLocalStorage("width_attachment_size"),[4,a.promiseSaveRoamingSetting()];case 11:return i.sent(),n=!0,[3,13];case 12:n=!0,i.label=13;case 13:return[3,23];case 14:m=i.sent(),i.label=15;case 15:return i.trys.push([15,20,,21]),console.error(m),o?[3,17]:[4,a.promiseDisplayMessage("アドインの処理エラーにより送信が中止されました。詳細："+m.message)];case 16:return i.sent(),[3,19];case 17:return[4,a.promiseDisplayMessage("確認ダイアログにより送信はキャンセルされました。")];case 18:i.sent(),i.label=19;case 19:return[3,21];case 20:return f=i.sent(),console.error(f),[3,21];case 21:return[3,23];case 22:try{window.localStorage.clear()}catch(e){console.error(e)}return e.completed({allowEvent:n}),[7];case 23:return[2]}}))}))}Office.onReady((function(){a.getGlobal().inspect=c})),function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n=void 0!==o?o:t;if(n)if("function"!=typeof n){for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){var r=void 0;try{r=n[s]}catch(e){continue}e.register(r,s,"C:\\Users\\youhei_mori\\Desktop\\RDI\\outlook-check-recipients-addin-github\\src\\onsend\\onsend.ts")}}else e.register(n,"module.exports","C:\\Users\\youhei_mori\\Desktop\\RDI\\outlook-check-recipients-addin-github\\src\\onsend\\onsend.ts")}}()},82702:function(e,t,n){e.exports=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,s=void 0,r=void 0,i=function(e,t){p[o]=e,p[o+1]=t,2===(o+=2)&&(r?r(d):S())};var a="undefined"!=typeof window?window:void 0,c=a||{},l=c.MutationObserver||c.WebKitMutationObserver,u="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),m="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(d,1)}}var p=new Array(1e3);function d(){for(var e=0;e<o;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;o=0}var g,h,y,v,S=void 0;function w(e,t){var n=this,o=new this.constructor(I);void 0===o[b]&&N(o);var s=n._state;if(s){var r=arguments[s-1];i((function(){return M(s,o,r,n._result)}))}else E(n,o,e,t);return o}function x(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(I);return T(t,e),t}S=u?function(){return process.nextTick(d)}:l?(h=0,y=new l(d),v=document.createTextNode(""),y.observe(v,{characterData:!0}),function(){v.data=h=++h%2}):m?((g=new MessageChannel).port1.onmessage=d,function(){return g.port2.postMessage(0)}):void 0===a?function(){try{var e=Function("return this")().require("vertx");return void 0!==(s=e.runOnLoop||e.runOnContext)?function(){s(d)}:f()}catch(e){return f()}}():f();var b=Math.random().toString(36).substring(2);function I(){}var _=void 0;function A(t,n,o){n.constructor===t.constructor&&o===w&&n.constructor.resolve===x?function(e,t){1===t._state?D(e,t._result):2===t._state?O(e,t._result):E(t,void 0,(function(t){return T(e,t)}),(function(t){return O(e,t)}))}(t,n):void 0===o?D(t,n):e(o)?function(e,t,n){i((function(e){var o=!1,s=function(e,t,n,o){try{e.call(t,n,o)}catch(e){return e}}(n,t,(function(n){o||(o=!0,t!==n?T(e,n):D(e,n))}),(function(t){o||(o=!0,O(e,t))}),e._label);!o&&s&&(o=!0,O(e,s))}),e)}(t,n,o):D(t,n)}function T(e,t){if(e===t)O(e,new TypeError("You cannot resolve a promise with itself"));else if(s=typeof(o=t),null===o||"object"!==s&&"function"!==s)D(e,t);else{var n=void 0;try{n=t.then}catch(t){return void O(e,t)}A(e,t,n)}var o,s}function R(e){e._onerror&&e._onerror(e._result),F(e)}function D(e,t){e._state===_&&(e._result=t,e._state=1,0!==e._subscribers.length&&i(F,e))}function O(e,t){e._state===_&&(e._state=2,e._result=t,i(R,e))}function E(e,t,n,o){var s=e._subscribers,r=s.length;e._onerror=null,s[r]=t,s[r+1]=n,s[r+2]=o,0===r&&e._state&&i(F,e)}function F(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var o=void 0,s=void 0,r=e._result,i=0;i<t.length;i+=3)o=t[i],s=t[i+n],o?M(n,o,s,r):s(r);e._subscribers.length=0}}function M(t,n,o,s){var r=e(o),i=void 0,a=void 0,c=!0;if(r){try{i=o(s)}catch(e){c=!1,a=e}if(n===i)return void O(n,new TypeError("A promises callback cannot return that same promise."))}else i=s;n._state!==_||(r&&c?T(n,i):!1===c?O(n,a):1===t?D(n,i):2===t&&O(n,i))}var P=0;function N(e){e[b]=P++,e._state=void 0,e._result=void 0,e._subscribers=[]}var B=function(){function e(e,n){this._instanceConstructor=e,this.promise=new e(I),this.promise[b]||N(this.promise),t(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&D(this.promise,this._result))):O(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===_&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,o=n.resolve;if(o===x){var s=void 0,r=void 0,i=!1;try{s=e.then}catch(e){i=!0,r=e}if(s===w&&e._state!==_)this._settledAt(e._state,t,e._result);else if("function"!=typeof s)this._remaining--,this._result[t]=e;else if(n===C){var a=new n(I);i?O(a,r):A(a,e,s),this._willSettleAt(a,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(o(e),t)},e.prototype._settledAt=function(e,t,n){var o=this.promise;o._state===_&&(this._remaining--,2===e?O(o,n):this._result[t]=n),0===this._remaining&&D(o,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;E(e,void 0,(function(e){return n._settledAt(1,t,e)}),(function(e){return n._settledAt(2,t,e)}))},e}();var C=function(){function t(e){this[b]=P++,this._result=this._state=void 0,this._subscribers=[],I!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){T(e,t)}),(function(t){O(e,t)}))}catch(t){O(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this,o=n.constructor;return e(t)?n.then((function(e){return o.resolve(t()).then((function(){return e}))}),(function(e){return o.resolve(t()).then((function(){throw e}))})):n.then(t,t)},t}();return C.prototype.then=w,C.all=function(e){return new B(this,e).promise},C.race=function(e){var n=this;return t(e)?new n((function(t,o){for(var s=e.length,r=0;r<s;r++)n.resolve(e[r]).then(t,o)})):new n((function(e,t){return t(new TypeError("You must pass an array to race."))}))},C.resolve=x,C.reject=function(e){var t=new this(I);return O(t,e),t},C._setScheduler=function(e){r=e},C._setAsap=function(e){i=e},C._asap=i,C.polyfill=function(){var e=void 0;if(void 0!==n.g)e=n.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var o=null;try{o=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===o&&!t.cast)return}e.Promise=C},C.Promise=C,C}()},73954:function(e){"use strict";e.exports=JSON.parse('{"documentRoot":"https://fukushima-computer-system.github.io/outlook-check-recipients-addin/dist/"}')}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var o=n(75081)}();
//# sourceMappingURL=onsend.js.map